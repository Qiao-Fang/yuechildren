<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>为你读书 | 在希望的田野上，点亮阅读之光</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            min-height: 100vh;
            overflow: hidden;
            position: relative;
            background: linear-gradient(135deg, #f5f5dc 0%, #e3f5ec 100%);
            color: #333;
            transition: background 1.5s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 70px;
        }
        
        /* 统一导航栏样式 */
        .nav-bar {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: flex;
            justify-content: center;
            transition: all 0.4s ease;
        }
        
        .nav-bar.scrolled {
            padding: 0.8rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }
        
        .nav-links {
            display: flex;
            gap: 5px;
        }
        
        .nav-link {
            color: #C19A6B;
            text-decoration: none;
            margin: 0 1.2rem;
            font-weight: bold;
            transition: all 0.3s ease;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            position: relative;
            padding: 8px 0;
            display: flex;
            align-items: center;
        }
        
        .nav-link i {
            margin-right: 8px;
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }
        
        .nav-link:hover {
            color: #7BA05B;
            transform: translateY(-3px);
        }
        
        .nav-link:hover i {
            transform: scale(1.2);
        }
        
        .nav-link.active {
            color: #7BA05B;
        }
        
        .nav-link.active::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: #7BA05B;
            border-radius: 2px;
            animation: underline 0.4s ease-out;
        }
        
        @keyframes underline {
            from { width: 0; }
            to { width: 100%; }
        }
        
        .nav-logo {
            position: absolute;
            left: 30px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            font-weight: bold;
            color: #C19A6B;
            font-size: 1.2rem;
        }
        
        .nav-logo i {
            margin-right: 10px;
            font-size: 1.5rem;
            color: #7BA05B;
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #C19A6B;
            cursor: pointer;
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        /* 标题样式 */
        .title-container {
            position: relative;
            text-align: center;
            z-index: 5;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .title {
            color: #C19A6B;
            font-size: 2.8rem;
            font-weight: 700;
            letter-spacing: 2px;
            margin-bottom: 15px;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            font-family: 'STKaiti', 'KaiTi', '楷体', serif;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #7BA05B;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        /* 北斗七星容器 */
        .big-dipper-container {
            position: relative;
            width: 90%;
            max-width: 700px;
            height: 500px;
            z-index: 3;
            margin-top: 20px;
        }
        
        /* 北斗七星连线 */
        .constellation-line {
            position: absolute;
            background: linear-gradient(90deg, rgba(123, 160, 91, 0.6), transparent);
            height: 3px;
            transform-origin: left center;
            z-index: 1;
        }
        
        /* 星星点 */
        .star {
            position: absolute;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: radial-gradient(circle, #7BA05B 30%, transparent 70%), 
                        radial-gradient(circle, #C19A6B 10%, transparent 60%);
            box-shadow: 0 0 20px rgba(123, 160, 91, 0.9),
                        0 0 40px rgba(193, 154, 107, 0.7);
            cursor: pointer;
            z-index: 2;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: pulse 2s infinite;
        }
        
        .star:hover {
            transform: scale(1.3);
            box-shadow: 0 0 25px rgba(123, 160, 91, 1),
                        0 0 50px rgba(193, 154, 107, 0.9);
            animation: none;
        }
        
        .star .book-name {
            position: absolute;
            top: 45px;
            width: max-content;
            font-size: 16px;
            font-weight: 500;
            color: #7BA05B;
            text-shadow: 0 0 8px rgba(0, 0, 0, 0.1);
            opacity: 0.9;
            transition: opacity 0.3s ease;
            text-align: center;
        }
        
        .star:hover .book-name {
            opacity: 1;
            text-shadow: 0 0 12px rgba(123, 160, 91, 0.9);
        }
        
        /* 浮动文字容器 */
        .text-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }
        
        /* 文本 */
        .text {
            position: absolute;
            font-size: 20px;
            font-weight: 600;
            color: rgba(51, 51, 51, 0.9);
            text-shadow: 0 0 10px rgba(193, 154, 107, 0.8);
            opacity: 0;
            transition: opacity 1.2s ease, transform 1.2s ease;
            max-width: 300px;
            text-align: center;
            line-height: 1.4;
            z-index: 2;
            font-family: 'STKaiti', 'KaiTi', '楷体', serif;
        }
        
        /* 星星装饰 */
        .star-deco {
            position: absolute;
            width: 3px;
            height: 3px;
            background: #C19A6B;
            border-radius: 50%;
            box-shadow: 0 0 5px #C19A6B, 0 0 10px #C19A6B;
            animation: twinkle 3s infinite;
            z-index: 1;
        }
        
        /* 朗读控制栏 */
        .reading-controls {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.8);
            padding: 15px 25px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 20px;
            z-index: 10;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .control-btn {
            background: none;
            border: none;
            color: #C19A6B;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .control-btn:hover {
            color: #7BA05B;
            transform: scale(1.1);
        }
        
        .book-info {
            text-align: center;
            min-width: 200px;
        }
        
        .book-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: #C19A6B;
        }
        
        .book-author {
            font-size: 0.9rem;
            color: #7BA05B;
        }
        
        /* 版权区样式 */
        .copyright-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(123,160,91,0.1);
            color: #578863;
            text-align: center;
            padding: 1.5rem;
            border-top: 1px solid rgba(123,160,91,0.15);
        }

        /* 动画效果 */
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 1; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(123, 160, 91, 0.9), 0 0 40px rgba(193, 154, 107, 0.7); }
            50% { transform: scale(1.1); box-shadow: 0 0 25px rgba(123, 160, 91, 1), 0 0 50px rgba(193, 154, 107, 0.9); }
        }
        
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(5deg); opacity: 0; }
        }

        /* 响应式设计 */
        @media (max-width: 1100px) {
            .nav-link {
                margin: 0 0.8rem;
                font-size: 0.95rem;
            }
            
            .nav-logo {
                left: 20px;
                font-size: 1.1rem;
            }
        }
        
        @media (max-width: 900px) {
            .nav-links {
                position: fixed;
                top: 70px;
                left: 0;
                right: 0;
                background: rgba(255, 255, 255, 0.98);
                flex-direction: column;
                align-items: center;
                padding: 20px 0;
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
                clip-path: polygon(0 0, 100% 0, 100% 0, 0 0);
                transition: clip-path 0.4s ease;
                gap: 15px;
            }
            
            .nav-links.active {
                clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
            }
            
            .nav-link {
                margin: 5px 0;
                padding: 10px 20px;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .nav-logo {
                left: 50%;
                transform: translateX(-50%) translateY(-50%);
            }
        }
        
        @media (max-width: 600px) {
            .title {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .reading-controls {
                flex-direction: column;
                gap: 10px;
                padding: 10px 20px;
            }
        }
    </style>
</head>
<body>
   <!-- 统一导航栏 -->
    <nav class="nav-bar" id="navBar">
        <div class="nav-logo">
            <i class="fas fa-book"></i>
            <span>点亮阅读之光</span>
        </div>
        
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>
        
        <div class="nav-links" id="navLinks">
            <a href="学校概况.html" class="nav-link">
                <i class="fas fa-school"></i>学校概况
            </a>
            <a href="人物故事.html" class="nav-link">
                <i class="fas fa-user"></i>人物故事
            </a>
            <a href="为你读书.html" class="nav-link active">
                <i class="fas fa-book-reader"></i>为你读书
            </a>
            <a href="行动支持.html" class="nav-link">
                <i class="fas fa-hands-helping"></i>行动支持
            </a>
        </div>
    </nav>
    
    <!-- 标题容器 -->
    <div class="title-container">
        <h1 class="title">为你读书</h1>
        <p class="subtitle">点击北斗七星中的星星，聆听乡村儿童喜爱的书籍朗读</p>
    </div>
    
    <!-- 北斗七星容器 -->
    <div class="big-dipper-container" id="constellation">
        <!-- 星星点将通过JS动态生成 -->
        <!-- 连线将通过JS动态生成 -->
    </div>
    
    <!-- 浮动文字容器 -->
    <div class="text-container" id="textContainer"></div>
    
    <!-- 背景装饰星星 -->
    <div id="stars"></div>
    
    <!-- 朗读控制栏 -->
    <div class="reading-controls">
        <button class="control-btn" id="prevBtn"><i class="fas fa-step-backward"></i></button>
        <button class="control-btn" id="playBtn"><i class="fas fa-play"></i></button>
        <button class="control-btn" id="nextBtn"><i class="fas fa-step-forward"></i></button>
        <div class="book-info">
            <div class="book-title" id="currentBookTitle">选择一本书籍</div>
            <div class="book-author" id="currentBookAuthor">点击上方星星开始</div>
        </div>
        <button class="control-btn" id="volumeBtn"><i class="fas fa-volume-up"></i></button>
    </div>
    
    <!-- 音频元素 -->
    <audio id="audioPlayer"></audio>
    
    <!-- 版权区 -->
    <footer class="copyright-footer">
        Copyright @乡村教育专题网页 rights reserved
    </footer>
    
    <script>
        // 导航栏滚动效果
        const navBar = document.getElementById('navBar');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                navBar.classList.add('scrolled');
            } else {
                navBar.classList.remove('scrolled');
            }
        });
        
        // 移动端菜单切换
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const navLinks = document.getElementById('navLinks');
        
        mobileMenuBtn.addEventListener('click', () => {
            navLinks.classList.toggle('active');
            const icon = mobileMenuBtn.querySelector('i');
            if (navLinks.classList.contains('active')) {
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-times');
            } else {
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
        });
        
        // 为当前页面设置活动状态
        document.addEventListener('DOMContentLoaded', function() {
            const links = document.querySelectorAll('.nav-link');
            links.forEach(link => {
                if (link.textContent.includes('为你读书')) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
        });
        
        // 书籍数据
        const books = [
            { 
                id: 1,
                title: "小王子", 
                author: "安托万·德·圣-埃克苏佩里", 
                excerpts: [
                    "如果你驯服了我，我们就互相不可缺少了。对我来说，你就是世界上唯一的了；我对你来说，也是世界上唯一的了。",
                    "只有用心灵才能看得清事物本质，真正重要的东西是肉眼无法看见的。",
                    "所有的大人都曾经是小孩，虽然，只有少数的人记得。",
                    "星星发亮是为了让每一个人有一天都能找到属于自己的星星。",
                    "使沙漠显得美丽的，是它在什么地方藏着一口水井。"
                ],
                audio: "音频/小王子.mp3",
                bgImage: "linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)",
                position: { top: "10%", left: "25%" }
            },
            { 
                id: 2,
                title: "草房子", 
                author: "曹文轩", 
                excerpts: [
                    "秋天的白云，温柔如絮，悠悠远去，梧桐的枯叶，正在秋风里忽闪忽闪地飘落。",
                    "太阳暖融融的，满地的紫云英，正蓬蓬勃勃地生长，在大地上堆起厚厚的绿色。",
                    "当时，那纯洁的白色将孩子们全都镇住了。加上秃鹤一副自信的样子，孩子们别无心思，只是一味默默地注视着。",
                    "微风翻卷着荷叶，又把清香吹得四处飘散。几支尚未绽开的荷花立在月色下像几支硕大的毛笔。",
                    "他看到空中一片星星点点的火花，并飘起一缕蓝烟。"
                ],
                audio: "音频/草房子.mp3",
                bgImage: "linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)",
                position: { top: "25%", left: "35%" }
            },
            { 
                id: 3,
                title: "安徒生童话", 
                author: "汉斯·克里斯汀·安徒生", 
                excerpts: [
                    "只要你是天鹅蛋，就是生在养鸡场里也没有什么关系。",
                    "当我还是一只丑小鸭的时候，我做梦也没有想到会有这么多的幸福！",
                    "她知道这是她看到他的最后一晚——为了他，她离开了她的族人和家庭，她交出了她美丽的声音。",
                    "在海的远处，水是那么蓝，像最美丽的矢车菊花瓣，同时又是那么清，像最明亮的玻璃。",
                    "每朵玫瑰都显出一种怡然自得的神态，就像我们心里充满了幸福的感觉的时候一样。"
                ],
                audio: "音频/安徒生童话.mp3",
                bgImage: "linear-gradient(135deg, #d299c2 0%, #fef9d7 100%)",
                position: { top: "40%", left: "45%" }
            },
            { 
                id: 4,
                title: "十万个为什么", 
                author: "米·伊林", 
                excerpts: [
                    "为什么铁会生锈？为什么面包放久了会发硬？为什么水能带走脏东西？",
                    "每一滴水里都藏着一个小小的世界，这个世界里有无数微小的生物。",
                    "太阳是一个巨大的火球，它发出的光和热让地球上的生命得以生存。",
                    "风是由于空气的流动产生的，当热空气上升，冷空气就会流过来填补它的位置。",
                    "植物的叶子为什么是绿色的？因为它们含有一种叫做叶绿素的物质。"
                ],
                audio: "音频/十万个为什么.mp3",
                bgImage: "linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%)",
                position: { top: "55%", left: "55%" }
            },
            { 
                id: 5,
                title: "伊索寓言", 
                author: "伊索", 
                excerpts: [
                    "一致是强有力的，而纷争易于被征服。",
                    "那些背叛同伴的人，常常不知不觉地把自己也一起毁灭了。",
                    "应当在朋友正是困难的时候给予帮助，不可在事情已经无望之后再说闲话。",
                    "对恶人做任何正当的辩解也是无效的。",
                    "天生要做坏事的人，如果找不到漂亮的借口，就会明目张胆地去作恶。"
                ],
                audio: "音频/伊索寓言.mp3",
                bgImage: "linear-gradient(135deg, #fdbb2d 0%, #22c1c3 100%)",
                position: { top: "65%", left: "70%" }
            },
            { 
                id: 6,
                title: "西游记", 
                author: "吴承恩", 
                excerpts: [
                    "花果山福地，水帘洞洞天。",
                    "心生，种种魔生；心灭，种种魔灭。",
                    "人没伤虎心，虎没伤人意。",
                    "不受苦中苦，难为人上人。",
                    "只要你见性志诚，念念回首处，即是灵山。"
                ],
                audio: "音频/西游记.mp3",
                bgImage: "linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)",
                position: { top: "50%", left: "80%" }
            },
            { 
                id: 7,
                title: "小橘灯", 
                author: "冰心", 
                excerpts: [
                    "这朦胧的橘红的光，实在照不了多远，但这小姑娘的镇定、勇敢、乐观的精神鼓舞了我，我似乎觉得眼前有无限光明！",
                    "我提着这灵巧的小橘灯，慢慢地在黑暗潮湿的山路上走着。",
                    "这小姑娘的镇定、勇敢、乐观的精神鼓舞了我。",
                    "她用小手在面前画一个圆圈，最后按到我的手上：'我们大家也都好了！'",
                    "我站起来要走，她拉住我，一面极其敏捷地拿过穿着麻线的大针，把那小橘碗四周相对地穿起来。"
                ],
                audio: "音频/小橘灯.mp3",
                bgImage: "linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%)",
                position: { top: "30%", left: "70%" }
            }
        ];
        
        // 北斗七星点之间的连线配置
        const connections = [
            { from: 1, to: 2 },  
            { from: 2, to: 3 }, 
            { from: 3, to: 4 },  
            { from: 4, to: 5 }, 
            { from: 5, to: 6 },  
            { from: 4, to: 7 }   
        ];
        
        // 初始化变量
        let currentBookId = null;
        let isPlaying = false;
        let textInterval = null;
        const constellationContainer = document.getElementById('constellation');
        const textContainer = document.getElementById('textContainer');
        const starsContainer = document.getElementById('stars');
        const audioPlayer = document.getElementById('audioPlayer');
        const playBtn = document.getElementById('playBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const volumeBtn = document.getElementById('volumeBtn');
        const bookTitleEl = document.getElementById('currentBookTitle');
        const bookAuthorEl = document.getElementById('currentBookAuthor');
        const defaultBg = 'linear-gradient(135deg, #f5f5dc 0%, #e3f5ec 100%)';
        
        // 创建装饰星星
        function createDecoStars() {
            for (let i = 0; i < 150; i++) {
                const star = document.createElement('div');
                star.className = 'star-deco';
                
                // 随机位置
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                
                // 随机大小
                const size = 1 + Math.random() * 2;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                
                // 随机动画延迟
                star.style.animationDelay = `${Math.random() * 5}s`;
                
                starsContainer.appendChild(star);
            }
        }
        
        // 计算两点之间的距离和角度
        function calculateLine(from, to) {
            const fromEl = document.querySelector(`.star[data-id="${from}"]`);
            const toEl = document.querySelector(`.star[data-id="${to}"]`);
            
            if (!fromEl || !toEl) return null;
            
            // 获取星星中心点相对于容器的位置
            const fromRect = fromEl.getBoundingClientRect();
            const toRect = toEl.getBoundingClientRect();
            const containerRect = constellationContainer.getBoundingClientRect();
            
            const fromX = fromRect.left + fromRect.width/2 - containerRect.left;
            const fromY = fromRect.top + fromRect.height/2 - containerRect.top;
            const toX = toRect.left + toRect.width/2 - containerRect.left;
            const toY = toRect.top + toRect.height/2 - containerRect.top;
            
            // 计算距离和角度
            const distance = Math.sqrt(Math.pow(toX - fromX, 2) + Math.pow(toY - fromY, 2));
            const angle = Math.atan2(toY - fromY, toX - fromX) * 180 / Math.PI;
            
            return {
                distance,
                angle,
                x: fromX,
                y: fromY
            };
        }
        
        // 创建北斗七星连线
        function createConnections() {
            // 移除旧连线
            document.querySelectorAll('.constellation-line').forEach(line => line.remove());
            
            // 创建新连线
            connections.forEach(conn => {
                const lineData = calculateLine(conn.from, conn.to);
                if (!lineData) return;
                
                const line = document.createElement('div');
                line.className = 'constellation-line';
                line.style.width = `${lineData.distance}px`;
                line.style.transform = `rotate(${lineData.angle}deg)`;
                line.style.left = `${lineData.x}px`;
                line.style.top = `${lineData.y}px`;
                
                constellationContainer.appendChild(line);
            });
        }
        
        // 创建星星点
        function createStars() {
            // 移除旧星星
            document.querySelectorAll('.star').forEach(star => star.remove());
            
            books.forEach(book => {
                // 创建星星点
                const star = document.createElement('div');
                star.className = 'star';
                star.dataset.id = book.id;
                star.style.top = book.position.top;
                star.style.left = book.position.left;
                
                // 添加书名
                const nameSpan = document.createElement('span');
                nameSpan.className = 'book-name';
                nameSpan.textContent = book.title;
                star.appendChild(nameSpan);
                
                // 点击事件
                star.addEventListener('click', () => playBook(book));
                
                constellationContainer.appendChild(star);
            });
        }
        
        // 显示浮动文字
        function showTexts(excerpts) {
            // 清除现有文字
            clearTexts();
            
            // 显示文字
            textInterval = setInterval(() => {
                if (!isPlaying) return;
                
                const textContent = excerpts[Math.floor(Math.random() * excerpts.length)];
                const textEl = document.createElement('div');
                textEl.className = 'text';
                textEl.textContent = textContent;
                
                // 随机位置
                const left = 10 + Math.random() * 80;
                const top = 20 + Math.random() * 60;
                textEl.style.left = `${left}%`;
                textEl.style.top = `${top}%`;
                
                // 随机字体大小
                const fontSize = 16 + Math.random() * 12;
                textEl.style.fontSize = `${fontSize}px`;
                
                // 随机颜色
                const colors = [
                    '#333333', '#7BA05B', '#C19A6B', '#5a8045', '#8B4513'
                ];
                textEl.style.color = colors[Math.floor(Math.random() * colors.length)];
                
                // 随机旋转
                const rotation = -10 + Math.random() * 20;
                textEl.style.transform = `rotate(${rotation}deg)`;
                
                // 添加动画
                textEl.style.animation = `float ${10 + Math.random() * 10}s linear forwards`;
                
                textContainer.appendChild(textEl);
                
                // 3秒后渐隐并移除
                setTimeout(() => {
                    textEl.style.opacity = '0';
                    setTimeout(() => {
                        if (textEl.parentNode) {
                            textEl.parentNode.removeChild(textEl);
                        }
                    }, 1200);
                }, 5000);
                
            }, 2000); // 2秒出现一次文字
        }
        
        // 清除所有文字
        function clearTexts() {
            // 清除文字生成器
            if (textInterval) {
                clearInterval(textInterval);
                textInterval = null;
            }
            
            // 渐隐所有现有文字
            const texts = document.querySelectorAll('.text');
            texts.forEach(text => {
                text.style.opacity = '0';
                text.style.transition = 'opacity 1.2s ease';
                
                setTimeout(() => {
                    if (text.parentNode) {
                        text.parentNode.removeChild(text);
                    }
                }, 1200);
            });
        }
        
        // 播放书籍朗读
        function playBook(book) {
            // 如果点击的是当前正在播放的书籍
            if (currentBookId === book.id && isPlaying) {
                pauseBook();
                return;
            }
            
            // 如果有其他书籍正在播放
            if (currentBookId && currentBookId !== book.id) {
                pauseBook();
            }
            
            // 设置新书籍
            currentBookId = book.id;
            isPlaying = true;
            
            // 更新UI
            playBtn.innerHTML = '<i class="fas fa-pause"></i>';
            bookTitleEl.textContent = book.title;
            bookAuthorEl.textContent = book.author;
            
            // 设置背景
            document.body.style.background = book.bgImage;
            
            // 显示文字
            showTexts(book.excerpts);
            
            // 设置音频源并播放
            audioPlayer.src = book.audio;
            audioPlayer.play();
            
            // 音频播放结束事件
            audioPlayer.onended = function() {
                pauseBook();
            };
        }
        
        // 暂停朗读
        function pauseBook() {
            isPlaying = false;
            
            // 更新UI
            playBtn.innerHTML = '<i class="fas fa-play"></i>';
            
            // 实际项目中需要取消注释
            // audioPlayer.pause();
            
            // 清除文字
            clearTexts();
            
            // 恢复默认背景
            document.body.style.background = defaultBg;
            
            currentBookId = null;
        }
        
        // 上一本书
        function prevBook() {
            if (currentBookId === null) return;
            
            let currentIndex = books.findIndex(book => book.id === currentBookId);
            let prevIndex = (currentIndex - 1 + books.length) % books.length;
            playBook(books[prevIndex]);
        }
        
        // 下一本书
        function nextBook() {
            if (currentBookId === null) return;
            
            let currentIndex = books.findIndex(book => book.id === currentBookId);
            let nextIndex = (currentIndex + 1) % books.length;
            playBook(books[nextIndex]);
        }
        
        // 切换播放状态
        function togglePlay() {
            if (currentBookId === null) {
                // 如果没有书籍在播放，播放第一本
                playBook(books[0]);
            } else if (isPlaying) {
                pauseBook();
            } else {
                // 继续播放
                isPlaying = true;
                playBtn.innerHTML = '<i class="fas fa-pause"></i>';
                // audioPlayer.play();
                showTexts(books.find(book => book.id === currentBookId).excerpts);
            }
        }
        
        // 初始化页面
        window.addEventListener('DOMContentLoaded', () => {
            createDecoStars();
            createStars();
            
            // 设置事件监听
            playBtn.addEventListener('click', togglePlay);
            prevBtn.addEventListener('click', prevBook);
            nextBtn.addEventListener('click', nextBook);
            
            volumeBtn.addEventListener('click', () => {
                const isMuted = audioPlayer.muted;
                audioPlayer.muted = !isMuted;
                volumeBtn.innerHTML = isMuted ? '<i class="fas fa-volume-up"></i>' : '<i class="fas fa-volume-mute"></i>';
            });
            
            // 延迟创建连线以确保星星位置已渲染
            setTimeout(() => {
                createConnections();
                
                // 添加窗口大小改变事件处理
                window.addEventListener('resize', () => {
                    createConnections();
                });
            }, 100);
        });
    </script>
</body>
</html>